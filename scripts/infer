#!/usr/local/bin/coffee
# inference command line interface

l = require '../src/loader.coffee'
m = require '../src/mmd.coffee'
o = require '../src/observe.coffee'
i = require '../src/infer.coffee'

main = (argv) ->
  if !argv[1]?
    console.log "Usage: #{argv[0]} FILE [ FILE ... ]"
    return

  watson = new o.Organizer()
  sherlock = new i.Inferrer()

  for file in argv.slice 1
    watson.analyze m l file

  console.log JSON.stringify sherlock.analyze({ inodes: watson.inodes_by_name, leaves: watson.leaves_by_name }), null, 2

main process.argv.slice 1
